<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ordine materiali</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="topbar">
  <div id="userStatus" style="color: #666; font-size: 0.85rem;">
    Verifica in corso...
  </div>
  
  <button id="openVisualizza" type="button" class="secondary" style="margin-left: auto;">
    Apri visualizzazione
  </button>
</header>



  <main class="container">
      

    <section id="loginBox" class="auth-box">
      <h2>Accesso</h2>

      <label>
        <span>Email</span>
        <input id="loginEmail" type="email" placeholder="nome.cognome@azienda.it" autocomplete="username" />
      </label>

      <div style="display:flex; gap:.5rem; align-items:flex-end; margin:.75rem 0;">
        <button id="btnSendOtp" type="button" style="flex:0 0 auto;">Invia codice</button>
      </div>

      <label>
        <span>Codice (6 cifre)</span>
        <input id="otpCode" type="text" inputmode="numeric" pattern="\d{6}" maxlength="6" placeholder="------" autocomplete="one-time-code" />
      </label>

      <button id="btnVerifyOtp" type="button">Verifica e accedi</button>

      <p id="loginMsg" class="auth-msg"></p>
    </section>



    <h1>Ordine materiali</h1>

    <section class="header-form">

      <label class="field">
        <span>Numero e nome commessa</span>
        <input id="jobRef" type="text" placeholder="Solo numero commessa" autocomplete="off" />
      </label>

      <label class="field">
      <span>Nome commessa</span>
      <input id="jobName" type="text" placeholder="es. SENNA XS per Migros" autocomplete="off" />
      </label>


      <label class="field">
      <span>Anno commessa</span>
      <select id="jobYear">
        <option value="2024">2024</option>
        <option value="2025" selected>2025</option>
        <option value="2026">2026</option>
        <option value="2027">2027</option>
        <option value="2028">2028</option>
        <option value="2029">2029</option>
        <option value="2030">2030</option>
      </select>
    </label>


      <label class="field">
        <span>Data richiesta</span>
        <input id="requestDate" type="date" />
      </label>
    </section>

    <section id="lines" class="lines"></section>
  </main>

  <template id="lineTemplate">
    <div class="line">
      <label class="cell">
        <span>Fornitore</span>
        <select class="supplier"></select>
      </label>

      <label class="cell qty">
        <span>Quantità</span>
        <div class="stepper">
          <input class="quantity" type="number" inputmode="numeric" min="0" step="1" value="0" />
          <button type="button" class="step down" aria-label="Decrementa">−</button>
          <button type="button" class="step up"   aria-label="Incrementa">+</button>
        </div>
      </label>


      <label class="cell code">
        <span>Codice</span>
        <input class="codeInput" type="text" autocomplete="off" placeholder="Digita codice..." />
        <ul class="suggestions"></ul>
      </label>

      <label class="cell desc">
        <span>Descrizione</span>
        <input class="descInput" type="text" autocomplete="off" placeholder="Digita descrizione..." />
        <ul class="suggestions"></ul>
      </label>
    </div>


  </template>



 <!--   <section id="lines" class="lines"></section>  -->

<div class="actions">
  <button id="saveSupabase" type="button">Salva in Visualizzazione</button>
 <button id="exportMail" type="button" disabled title="Salva prima su Supabase">
  Invia email
</button>
</div>

<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="login.js" defer></script>
<script src="app.js" defer></script>
<script src="supabase-save.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

<!-- Container per i toast -->
<div id="toastContainer"></div>
<script src="modal-toast.js" defer></script>

</body>
</html>
